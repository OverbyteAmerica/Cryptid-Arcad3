<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>DEFENDERS ‚Äî Lab 2: Signal in the Noise</title>
<style>
*,*::before,*::after{box-sizing:border-box;}
body{background-color:#000;color:#00ffcc;font-family:'Courier New',Courier,monospace;font-size:16px;line-height:1.4;margin:0;padding:20px;overflow-x:hidden;}
h1,h2,h3,h4{font-family:'Courier New',Courier,monospace;color:#00ffcc;margin:0 0 12px 0;}
h1{font-size:2rem;}h2{font-size:1.6rem;}h3{font-size:1.3rem;}
a{color:#00ffcc;text-decoration:none;}a:hover{text-decoration:underline;}
.hidden{display:none;}.center{text-align:center;}
.panel{border:1px solid #00ffcc;padding:18px;margin:20px 0;background-color:rgba(0,0,0,0.85);border-radius:6px;box-shadow:0 0 12px rgba(0,255,204,0.4);}
button{background-color:#000;border:1px solid #00ffcc;color:#00ffcc;padding:10px 16px;cursor:pointer;font-family:monospace;font-size:0.95rem;border-radius:4px;transition:all 0.2s ease;display:inline-block;}
button:hover{background-color:#002;box-shadow:0 0 8px #00ffcc;}
button:disabled{opacity:0.4;cursor:not-allowed;}
#cookie{position:fixed;top:20px;right:20px;width:240px;border:1px solid #00ffcc;background:#000;padding:12px;box-shadow:0 0 18px rgba(0,255,204,.5);font-size:0.9rem;z-index:9999;border-radius:8px;}
#cookie-avatar{font-size:1.6rem;margin-bottom:6px;}
#cookie-text{opacity:0.95;line-height:1.4;}
#cookie::before{content:"";position:absolute;inset:0;background:linear-gradient(rgba(0,255,204,0.05),transparent);pointer-events:none;}
.boot{font-size:1.1rem;margin-bottom:20px;white-space:pre-wrap;word-break:break-word;min-height:60px;}
.typing-cursor::after{content:"_";animation:blink 1s step-end infinite;}
@keyframes blink{from,to{opacity:0;}50%{opacity:1;}}
.log{background-color:#001;border:1px solid #00ffcc;padding:12px;margin-top:20px;height:220px;overflow-y:auto;font-size:0.85rem;border-radius:4px;box-shadow:0 0 10px rgba(0,255,204,0.3);}
.log p{margin:3px 0;}.warn{color:#ffaa00;}.danger{color:#ff4444;}.success{color:#00ffcc;}.info{color:#888;}
#pb-outer{background:rgba(0,255,204,0.1);border:1px solid #00ffcc44;border-radius:4px;height:8px;margin:10px 0 20px;overflow:hidden;}
#pb{height:100%;background:#00ffcc;width:0%;transition:width 0.5s ease;box-shadow:0 0 8px #00ffcc;}
.node-action{display:flex;align-items:flex-start;gap:16px;margin:14px 0;padding:14px;border:1px solid rgba(0,255,204,0.18);border-radius:4px;}
.node-action .desc{flex:1;font-size:0.85rem;opacity:0.75;line-height:1.6;}
.node-action button{min-width:210px;text-align:left;}
.cmd{font-size:0.75rem;opacity:0.5;display:block;margin-top:4px;font-style:italic;}
</style>
</head>
<body>

<div id="cookie"><div id="cookie-avatar">üêæ</div><div id="cookie-text">COOKIE v1.3 ‚Äî Lab 2 online. Something's moving in the network. I can feel it.</div></div>

<h1>DEFENDERS GUILD</h1>
<p style="opacity:0.6;margin:0 0 4px;">SEASON 1 ‚Äî PHASE 1: ORIENTATION</p>
<h2>LAB 02 // SIGNAL IN THE NOISE</h2>
<div id="pb-outer"><div id="pb"></div></div>

<div class="panel"><div class="boot typing-cursor" id="boot-text"></div></div>

<div class="panel">
  <h3>üìã MISSION BRIEF</h3>
  <p><strong>Skill Focus:</strong> Packet capture ¬∑ Traffic analysis ¬∑ Anomaly detection</p>
  <p><strong>Role Alignment:</strong> SOC Tier 1 / Network Analyst</p>
  <p><strong>Story Context:</strong> Node Cluster 01 is back online ‚Äî but the traffic coming off it doesn't look right. Unusual packet volumes, connections to unregistered external IPs, and a warning from another Defender: <em>"They are already inside."</em> Before this escalates into a full breach, you need to capture what's moving across the wire, analyze it, and identify whether Byte Bug activity is already underway. What you find here will feed directly into Lab 3.</p>
  <p><strong>Objectives:</strong> Capture live traffic ¬∑ Analyze packets for suspicious patterns ¬∑ Detect and confirm anomalous behavior</p>
</div>

<!-- TASK 1 -->
<div class="panel">
  <h3>TASK 1 ‚Äî PACKET CAPTURE</h3>
  <p style="opacity:0.7;font-size:0.85rem;">You can't analyze traffic you haven't captured. <code>tcpdump</code> writes a full record of everything crossing the interface to a file ‚Äî every connection, every handshake, every byte. In a real SOC this is often the first thing you run the moment something looks wrong, so you have evidence before it disappears.</p>
  <div class="node-action">
    <button id="btn-capture" onclick="doCapture()">‚ñ∂ CAPTURE PACKETS<span class="cmd">&lt;tcpdump -i eth0 -w capture.pcap&gt;</span></button>
    <div class="desc">Record all traffic on the primary interface to <code>capture.pcap</code>. Every packet is logged ‚Äî clean traffic, suspicious traffic, and anything in between. This is your raw evidence file for everything that follows.</div>
  </div>
  <p id="capture-status" style="margin-top:8px;font-size:0.85rem;color:#888;"></p>
</div>

<!-- TASK 2 -->
<div class="panel">
  <h3>TASK 2 ‚Äî PACKET ANALYSIS</h3>
  <p style="opacity:0.7;font-size:0.85rem;">Raw packet files are unreadable without tooling. Wireshark decodes the capture and lets you filter, sort, and inspect individual connections. Analysts use it to find unexpected protocols, unusual source IPs, and traffic patterns that don't match the baseline ‚Äî the kind of things that look innocent until you put them side by side.</p>
  <div class="node-action">
    <button id="btn-analyze" onclick="doAnalyze()">‚ñ∂ ANALYZE PACKETS<span class="cmd">&lt;wireshark capture.pcap&gt;</span></button>
    <div class="desc">Open the capture in Wireshark and filter for anomalies. Look for connections to unrecognized IPs, unusual port usage, or traffic spikes that don't match normal activity on this cluster. One device in particular has been making calls it shouldn't.</div>
  </div>
  <p id="analyze-status" style="margin-top:8px;font-size:0.85rem;color:#888;"></p>
</div>

<!-- TASK 3 -->
<div class="panel">
  <h3>TASK 3 ‚Äî ANOMALY DETECTION</h3>
  <p style="opacity:0.7;font-size:0.85rem;">Analysis finds the suspicious traffic. Detection confirms it's malicious. Signature matching compares what you've captured against known attack patterns ‚Äî if a Byte Bug payload has been active, it will have left traces that match Asher's known methods. This step turns a suspicion into a confirmed incident and triggers escalation to Lab 3.</p>
  <div class="node-action">
    <button id="btn-detect" onclick="doDetect()">‚ñ∂ DETECT ANOMALIES<span class="cmd">&lt;grep -i "malicious\|byte_bug\|beacon" capture.pcap&gt;</span></button>
    <div class="desc">Run signature detection across the capture file. If Byte Bug activity is present, this will surface it. A confirmed hit here means the anomalies aren't noise ‚Äî they're the opening moves of a coordinated attack, and Lab 3 is already in motion.</div>
  </div>
  <p id="detect-status" style="margin-top:8px;font-size:0.85rem;color:#888;"></p>
</div>

<div class="log" id="log">
  <p class="info">// LAB 2 INITIALIZED ‚Äî PACKET ANALYSIS MODULE LOADED</p>
  <p class="info">// Awaiting Defender input...</p>
</div>

<div class="panel hidden" id="complete-panel" style="box-shadow:0 0 24px rgba(0,255,204,0.6);">
  <h3 style="font-size:1.4rem;">‚úÖ LAB 2 COMPLETE ‚Äî ANOMALY CONFIRMED</h3>
  <p>Traffic captured. Suspicious connection identified. Byte Bug signature match confirmed.</p>
  <p style="color:#888;font-size:0.85rem;">The packet stream carried more than anomalous data ‚Äî buried in a corrupted fragment was a message: <em>"They are already inside."</em> This wasn't an accident. The Byte Bugs are already staging across multiple nodes. Asher's campaign has begun. Lab 3 is now active.</p>
  <p><strong>SKILLS EARNED:</strong> Packet Capture ¬∑ Wireshark Analysis ¬∑ Signature Detection ¬∑ Incident Escalation</p>
  <p><strong>CAREER RELEVANCE:</strong> SOC Tier 1 ¬∑ Network Analyst ¬∑ Incident Responder</p>
  <br>
  <div style="display:flex;gap:14px;flex-wrap:wrap;margin-top:8px;">
    <a href="s1-lab3.html"><button>‚Üí PROCEED TO LAB 3: MALWARE TRIAGE</button></a>
    <a href="defenders-dashboard.html"><button style="border-color:#555;color:#888;">‚åÇ BACK TO DASHBOARD</button></a>
  </div>
</div>

<script>
const narrative=`> DEFENDERS GUILD ‚Äî BOOTLOADER v1.0\n> Node Cluster 02 status: UNSTABLE\n> Anomalous traffic detected across 3 segments\n> Source: UNKNOWN\n> Defender ‚Äî capture the wire before the evidence is gone.`;
let ci=0;const be=document.getElementById('boot-text');
function typeIt(){if(ci<narrative.length){be.textContent+=narrative[ci++];setTimeout(typeIt,28);}else{be.classList.remove('typing-cursor');setTimeout(()=>cookie('I\'m online. Ready to see what\'s moving in the network? Something isn\'t right ‚Äî I can tell by the packet timing alone.'),400);}}
typeIt();

const phases={p1:false,p2:false,p3:false};
function updatePB(){const d=Object.values(phases).filter(Boolean).length;document.getElementById('pb').style.width=(d/3*100)+'%';if(d===3)setTimeout(showComplete,600);}
function lg(m,c=''){const l=document.getElementById('log');const p=document.createElement('p');if(c)p.className=c;p.textContent=m;l.appendChild(p);l.scrollTop=l.scrollHeight;}
function cookie(m){document.getElementById('cookie-text').textContent=m;}

function doCapture(){
  const btn=document.getElementById('btn-capture');
  if(btn.disabled)return;
  btn.disabled=true;
  lg('> defender@boot:~$ tcpdump -i eth0 -w capture.pcap');
  lg('> Binding to interface eth0...');
  cookie('Good. Get everything down to file first. You can\'t analyze what you haven\'t captured.');
  setTimeout(()=>lg('> Packets incoming ‚Äî logging to capture.pcap'),600);
  setTimeout(()=>lg('> 1,204 packets captured in 4.2 seconds'),1100);
  setTimeout(()=>lg('> WARNING: Encrypted stream to external IP 203.0.113.44 logged','warn'),1600);
  setTimeout(()=>lg('> Capture complete. File written: capture.pcap (2.1 MB)','success'),2100);
  setTimeout(()=>{
    document.getElementById('capture-status').innerHTML='<span style="color:#00ffcc;">‚úì Capture complete ‚Äî 1,204 packets logged including suspicious outbound stream. Task 1 done.</span>';
    phases.p1=true;updatePB();
    cookie('That outbound stream to 203.0.113.44 ‚Äî that IP isn\'t on any known allowlist. Flag it for analysis.');
  },2200);
}

function doAnalyze(){
  const btn=document.getElementById('btn-analyze');
  if(btn.disabled)return;
  btn.disabled=true;
  lg('> defender@boot:~$ wireshark capture.pcap');
  lg('> Parsing capture file...');
  cookie('Filter by destination IP first. Anything going outside the subnet without authorization is your lead.');
  setTimeout(()=>lg('> Decoded 1,204 packets across 7 protocols'),700);
  setTimeout(()=>lg('> Filtering for external destinations...'),1200);
  setTimeout(()=>lg('> ANOMALY: 192.168.42.7 ‚Üí 203.0.113.44 ‚Äî 847 packets, port 443','warn'),1700);
  setTimeout(()=>lg('> 192.168.42.7 is not a registered device on this cluster','danger'),2200);
  setTimeout(()=>lg('> Analysis complete. Unregistered device flagged as primary suspect.','success'),2700);
  setTimeout(()=>{
    document.getElementById('analyze-status').innerHTML='<span style="color:#00ffcc;">‚úì Analysis complete ‚Äî unregistered host 192.168.42.7 flagged for 847-packet exfil attempt. Task 2 done.</span>';
    phases.p2=true;updatePB();
    cookie('192.168.42.7 shouldn\'t exist on this cluster. That device was placed there. This isn\'t random.');
  },2800);
}

function doDetect(){
  const btn=document.getElementById('btn-detect');
  if(btn.disabled)return;
  btn.disabled=true;
  lg('> defender@boot:~$ grep -i "malicious\\|byte_bug\\|beacon" capture.pcap');
  lg('> Running signature match against capture...');
  cookie('This is the moment of confirmation. Either it\'s noise, or it\'s Asher. Let\'s find out.');
  setTimeout(()=>lg('> Scanning 2.1 MB capture for known signatures...'),700);
  setTimeout(()=>lg('> MATCH: byte_bug beacon pattern ‚Äî packet offset 0x3A4F','danger'),1400);
  setTimeout(()=>lg('> MATCH: corrupted payload fragment recovered:','warn'),1900);
  setTimeout(()=>lg('> FRAGMENT: "They are already inside."','danger'),2300);
  setTimeout(()=>lg('> MATCH: Asher signature string ASHER-MUT-0x3A in packet header','danger'),2800);
  setTimeout(()=>lg('> Detection complete. 3 confirmed Byte Bug signatures. Escalating to Lab 3.','success'),3300);
  setTimeout(()=>{
    document.getElementById('detect-status').innerHTML='<span style="color:#ff4444;">‚ö† CONFIRMED ‚Äî Byte Bug signatures detected. Asher-MUT-0x3A active. Escalating to malware triage.</span>';
    phases.p3=true;updatePB();
    cookie('Three signature hits. That\'s not ambiguous ‚Äî Asher\'s Byte Bugs are live on this network. Lab 3 is waiting.');
  },3400);
}

function showComplete(){
  localStorage.setItem('s1lab2','complete');
  document.getElementById('complete-panel').classList.remove('hidden');
  document.getElementById('complete-panel').scrollIntoView({behavior:'smooth'});
  lg('>>> LAB 2 COMPLETE. BYTE BUG PRESENCE CONFIRMED. ESCALATING. <<<','success');
  cookie('Lab 2 done. The anomalies are real and Asher is already moving. Head to Lab 3 ‚Äî the triage won\'t wait.');
}
</script>
</body>
</html>
